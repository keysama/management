webpackJsonp([9],{I6Le:function(t,e,s){"use strict";(function(t){var a=s("Xxa5"),n=s.n(a),r=s("Dd8w"),i=s.n(r),o=s("exGp"),c=s.n(o),l=s("aK6G"),u=s("dBkQ"),m=s("TbzR");e.a={created:function(){""!=this.$store.state.newPro.number&&""!=this.$store.state.newPro.name||this.$router.push("/addPro/step1"),this.init()},data:function(){return{members:[],input:"",book:[],select:[],jobs:[0]}},methods:{init:function(){var t=this;return c()(n.a.mark(function e(){var s;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.members=t.$store.state.newPro.members,t.members[0]=i()({},t.$store.state.userInfo,{job:0}),e.next=4,Object(l.c)();case 4:if(1==(s=e.sent).data.res){e.next=8;break}return alert(s.data.text),e.abrupt("return");case 8:t.book=s.data.body;case 10:case"end":return e.stop()}},e,t)}))()},collapse:function(e){t("#"+e).toggle()},active:function(){alert("ok")},add:function(){var t=this;return c()(n.a.mark(function e(){var s;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!=t.input){e.next=3;break}return alert("不能为空"),e.abrupt("return");case 3:return e.next=5,Object(l.d)({username:t.input});case 5:if(1==(s=e.sent).data.res){e.next=9;break}return alert(s.data.text),e.abrupt("return");case 9:if(!(t.members.filter(function(t){return t.id==s.data.body.id}).length>0)){e.next=13;break}return alert("用户已存在"),e.abrupt("return");case 13:t.members.push(i()({},s.data.body,{job:1})),t.input="";case 15:case"end":return e.stop()}},e,t)}))()},jobChange:function(t){this.members[t].job=this.jobs[t]},push_select:function(){var t=this;this.select_member.filter(function(e){return t.members.map(function(t){return t.id}).indexOf(e.id)<0}).forEach(function(e){t.members.push(e)})},remove:function(t){this.members=this.members.filter(function(e,s){return s!=t})},finish:function(){var t=this;return c()(n.a.mark(function e(){var s,a;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=i()({},t.$store.state.newPro,{members:t.members.map(function(t){return{id:t.id,job:t.job}})}),t.$store.commit(m.b),e.next=4,Object(u.a)(s);case 4:if(a=e.sent,t.$store.commit(m.a),1==a.data.res){e.next=9;break}return alert(a.data.text),e.abrupt("return");case 9:alert("工程创建成功，即将跳转到工程管理页面"),t.$router.push("/pro/"+a.data.body+"/set");case 11:case"end":return e.stop()}},e,t)}))()}},computed:{book_member:function(){return this.book.map(function(t){return t.member})},select_member:function(){var t=this,e=[];return this.select.forEach(function(s){t.book_member.forEach(function(t){t.forEach(function(t){t.member==s&&(t.id=t.member,t.job=1,e.push(t))})})}),e}},watch:{members:{handler:function(t,e){this.$store.commit(m.f,t),this.jobs=t.map(function(t){return t.job})},immediate:!1,deep:!0}}}}).call(e,s("4kSj"))},hiOt:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("I6Le"),n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-4 offset-md-4"},[t._m(0),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.members.length>0,expression:"members.length>0"}],staticClass:"form-group"},[s("label",[t._v("参与人列表:")]),t._v(" "),s("ul",{staticClass:"list-group"},t._l(t.members,function(e,a){return s("li",{key:a,staticClass:"list-group-item d-flex justify-content-between align-items-center",class:{"list-group-item-success":0!=a,"list-group-item-info":0==a},staticStyle:{position:"relative"}},[s("span",[t._v(t._s(e.nickname)+"(账号:"+t._s(e.username)+")")]),t._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.jobs[a],expression:"jobs[key]"}],staticClass:"form-control",staticStyle:{width:"auto"},on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.jobs,a,e.target.multiple?s:s[0])},function(e){t.jobChange(a)}]}},0==a?[s("option",{attrs:{value:"0"}},[t._v("创建者")])]:[s("option",{attrs:{value:"1"}},[t._v("参与人")]),t._v(" "),s("option",{attrs:{value:"2"}},[t._v("材料商")]),t._v(" "),s("option",{attrs:{value:"3"}},[t._v("领导")])]),t._v(" "),0!=a?s("span",{staticClass:"delete pointer",staticStyle:{position:"absolute",top:"1px",right:"3px"},on:{click:function(e){t.remove(a)}}},[t._v("×")]):t._e()])}))]),t._v(" "),s("div",{staticClass:"d-flex flex-wrap justify-content-between",staticStyle:{"margin-bottom":"30px"}},[s("label",{staticStyle:{"padding-top":"5px"}},[t._v("添加参与人:")]),t._v(" "),s("div",{staticClass:"d-flex justify-content-center w-100"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.input,expression:"input"}],staticClass:"form-control",attrs:{type:"text",placeholder:"对方手机号/账户"},domProps:{value:t.input},on:{input:function(e){e.target.composing||(t.input=e.target.value)}}}),t._v(" "),s("button",{staticClass:"btn btn-info",staticStyle:{"margin-left":"10px"},attrs:{type:"button"},on:{click:t.add}},[t._v("添加")])])]),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),s("div",{staticClass:"controller"},[s("router-link",{staticClass:"btn btn-outline-primary w-40",attrs:{to:"/addPro/step1"}},[t._v("上一步")]),t._v(" "),s("button",{staticClass:"btn btn-outline-primary w-40",attrs:{type:"button"},on:{click:t.finish}},[t._v("完成")])],1),t._v(" "),t._m(3)]),t._v(" "),s("div",{staticClass:"modal fade",attrs:{id:"select"}},[s("div",{staticClass:"modal-dialog"},[s("div",{staticClass:"modal-content"},[t._m(4),t._v(" "),s("div",{staticClass:"modal-body"},[s("ul",{staticClass:"list-group"},t._l(t.book,function(e,a){return s("li",{key:a,ref:a,refInFor:!0,staticClass:"list-group-item pointer",attrs:{"data-toggle":"collapse","data-target":a},on:{click:function(e){t.collapse(a)}}},[t._v("\r\n                                        "+t._s(e.name)+"\r\n                                        "),s("span",{staticClass:"badge badge-pill badge-info"},[t._v(t._s(e.member.length))]),t._v(" "),s("div",{staticClass:"collapse",attrs:{id:a}},[s("ul",{staticClass:"list-group",staticStyle:{"padding-left":"30px"}},t._l(e.member,function(e,a){return s("label",{key:a,staticClass:"form-check-label"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.select,expression:"select"}],staticClass:"form-check-input",attrs:{type:"checkbox"},domProps:{value:e.member,checked:Array.isArray(t.select)?t._i(t.select,e.member)>-1:t.select},on:{click:function(t){t.stopPropagation()},change:function(s){var a=t.select,n=s.target,r=!!n.checked;if(Array.isArray(a)){var i=e.member,o=t._i(a,i);n.checked?o<0&&(t.select=a.concat([i])):o>-1&&(t.select=a.slice(0,o).concat(a.slice(o+1)))}else t.select=r}}}),t._v(t._s(e.nickname)+"\r\n                                                ")])}))])])}))]),t._v(" "),s("div",{staticClass:"modal-footer"},[t._v("\r\n                                已选择："),t._l(t.select_member,function(e,a){return s("span",{key:a},[t._v(t._s(e.nickname))])}),t._v(" "),s("button",{staticClass:"btn btn-success",attrs:{type:"button","data-dismiss":"modal"},on:{click:t.push_select}},[t._v("确定")])],2)])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"d-flex justify-content-center align-items-center"},[e("span",{staticClass:"step step1 text-center",staticStyle:{flex:"2"}},[this._v("项目信息")]),this._v(" "),e("span",{staticClass:"step step2 text-center active",staticStyle:{flex:"2"}},[this._v("人员列表")]),this._v(" "),e("span",{staticClass:"step step3 text-center",staticStyle:{flex:"1"}},[this._v("完成")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"d-flex flex-wrap justify-content-between"},[e("label",[this._v("从通讯录中选择:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"d-flex flex-wrap justify-content-center",staticStyle:{"margin-top":"10px"}},[e("button",{staticClass:"btn btn-info w-50",staticStyle:{"font-size":".5rem"},attrs:{type:"button","data-toggle":"modal","data-target":"#select"}},[this._v("选择通讯录")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"d-flex flex-wrap justify-content-center",staticStyle:{"margin-top":"10px"}},[e("small",{staticClass:"text-secondary"},[this._v("选择完成后将发送邀请")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-header"},[e("h4",{staticClass:"modal-title"},[this._v("联系人列表")]),this._v(" "),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal"}},[this._v("×")])])}]};var r=function(t){s("uB+w")},i=s("VU/8")(a.a,n,!1,r,"data-v-b2100cd4",null);e.default=i.exports},"uB+w":function(t,e){}});
//# sourceMappingURL=9.ea98f23f05252af1d842.js.map